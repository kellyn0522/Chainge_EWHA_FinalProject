{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\\\uC774\\uAC00\\uC740\\\\OneDrive\\\\\\uBB38\\uC11C\\\\GitHub\\\\FinalProject\\\\moon2\\\\src\\\\component\\\\chat\\\\ChatBox.jsx\",\n  _s = $RefreshSig$();\nimport { useContext, useEffect, useRef, useState } from \"react\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport { useFetchRecipientUser } from \"../../hooks/useFetchRecipient\";\nimport { ChatContext } from \"../../context/ChatContext\";\nimport Stack from 'react-bootstrap/Stack';\nimport moment from \"moment\";\nimport InputEmoji from \"react-input-emoji\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ChatBox = () => {\n  _s();\n  const {\n    user\n  } = useContext(AuthContext);\n  const {\n    currentChat,\n    messages,\n    isMessagesLoading,\n    sendTextMessage\n  } = useContext(ChatContext);\n  const {\n    recipientUser\n  } = useFetchRecipientUser(currentChat, user);\n  const [textMessage, setTextMessage] = useState(\"\");\n  const scroll = useRef();\n  console.log(\"text\", textMessage);\n  useEffect(() => {\n    var _scroll$current;\n    (_scroll$current = scroll.current) === null || _scroll$current === void 0 ? void 0 : _scroll$current.scrollIntroView({\n      behavior: \"smooth\"\n    });\n  }, [messages]);\n\n  // 디버깅용 콘솔 로그 추가\n  //console.log('recipientUser:', recipientUser);\n  //console.log('isMessagesLoading:', isMessagesLoading);\n\n  if (!recipientUser) return /*#__PURE__*/_jsxDEV(\"p\", {\n    style: {\n      textAlign: \"center\",\n      width: \"100%\"\n    },\n    children: \"No conversation selected yet ...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 28,\n    columnNumber: 9\n  }, this);\n  if (isMessagesLoading) return /*#__PURE__*/_jsxDEV(\"p\", {\n    style: {\n      textAlign: \"center\",\n      width: \"100%\"\n    },\n    children: \"Loading Chat...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 35,\n    columnNumber: 13\n  }, this);\n  return /*#__PURE__*/_jsxDEV(Stack, {\n    gap: 4,\n    className: \"chat-box\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-header\",\n      children: /*#__PURE__*/_jsxDEV(\"strong\", {\n        children: recipientUser === null || recipientUser === void 0 ? void 0 : recipientUser.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 43,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Stack, {\n      gap: 3,\n      className: \"messages\",\n      children: messages && messages.map((message, index) => {\n        return /*#__PURE__*/_jsxDEV(Stack, {\n          className: ` \n                            ${(message === null || message === void 0 ? void 0 : message.senderId) === (user === null || user === void 0 ? void 0 : user._id) ? \"message self align-self-end flex-grow-0 \" : \"message align-self-start flex-grow-0\"}`,\n          ref: scroll,\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: [\" \", message.text]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 55,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"message-footer\",\n            children: moment(message.createdAt).calendar()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 56,\n            columnNumber: 29\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 48,\n          columnNumber: 25\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Stack, {\n      direction: \"horizontal\",\n      gap: 3,\n      className: \"chat-input flex-grow-0\",\n      children: [/*#__PURE__*/_jsxDEV(InputEmoji, {\n        value: textMessage,\n        onChange: setTextMessage,\n        borderColor: \"rgba(72,112,223,0.2)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"send-btn\",\n        onClick: () => sendTextMessage(textMessage, user, currentChat._id, sendTextMessage),\n        children: /*#__PURE__*/_jsxDEV(\"svg\", {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"16\",\n          height: \"16\",\n          fill: \"currentColor\",\n          className: \"bi bi-send-fill\",\n          viewBox: \"0 0 16 16\",\n          children: /*#__PURE__*/_jsxDEV(\"path\", {\n            d: \"M15.964.686a.5.5 0 0 0-.65-.65L.767 5.855H.766l-.452.18a.5.5 0 0 0-.082.887l.41.26.001.002 4.995 3.178 3.178 4.995.002.002.26.41a.5.5 0 0 0 .886-.083zm-1.833 1.89L6.637 10.07l-.215-.338a.5.5 0 0 0-.154-.154l-.338-.215 7.494-7.494 1.178-.471z\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 71,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 41,\n    columnNumber: 9\n  }, this);\n};\n_s(ChatBox, \"/UsKC23JeBUASUez9bhZPQJEP54=\", false, function () {\n  return [useFetchRecipientUser];\n});\n_c = ChatBox;\nexport default ChatBox;\nvar _c;\n$RefreshReg$(_c, \"ChatBox\");","map":{"version":3,"names":["useContext","useEffect","useRef","useState","AuthContext","useFetchRecipientUser","ChatContext","Stack","moment","InputEmoji","jsxDEV","_jsxDEV","ChatBox","_s","user","currentChat","messages","isMessagesLoading","sendTextMessage","recipientUser","textMessage","setTextMessage","scroll","console","log","_scroll$current","current","scrollIntroView","behavior","style","textAlign","width","children","fileName","_jsxFileName","lineNumber","columnNumber","gap","className","name","map","message","index","senderId","_id","ref","text","createdAt","calendar","direction","value","onChange","borderColor","onClick","xmlns","height","fill","viewBox","d","_c","$RefreshReg$"],"sources":["C:/Users/이가은/OneDrive/문서/GitHub/FinalProject/moon2/src/component/chat/ChatBox.jsx"],"sourcesContent":["import { useContext, useEffect, useRef, useState } from \"react\";\r\nimport { AuthContext } from \"../../context/AuthContext\";\r\nimport { useFetchRecipientUser } from \"../../hooks/useFetchRecipient\";\r\nimport { ChatContext } from \"../../context/ChatContext\";\r\nimport Stack from 'react-bootstrap/Stack';\r\nimport moment from \"moment\";\r\nimport InputEmoji from \"react-input-emoji\";\r\n\r\nconst ChatBox = () => {\r\n    const { user } = useContext(AuthContext);\r\n    const { currentChat, messages, isMessagesLoading ,sendTextMessage} = useContext(ChatContext);\r\n    const { recipientUser } = useFetchRecipientUser(currentChat, user);\r\n    const [textMessage, setTextMessage] = useState(\"\");\r\n    const scroll = useRef();\r\n\r\n    console.log(\"text\", textMessage);\r\n    useEffect(() => {\r\n        scroll.current?.scrollIntroView({behavior :\"smooth\"});\r\n\r\n    },[messages]);\r\n\r\n\r\n    // 디버깅용 콘솔 로그 추가\r\n    //console.log('recipientUser:', recipientUser);\r\n    //console.log('isMessagesLoading:', isMessagesLoading);\r\n\r\n    if (!recipientUser) return (\r\n        <p style={{ textAlign: \"center\", width: \"100%\" }}>\r\n            No conversation selected yet ...\r\n        </p>\r\n    );\r\n\r\n    if (isMessagesLoading)\r\n        return (\r\n            <p style={{ textAlign: \"center\", width: \"100%\" }}>\r\n                Loading Chat...\r\n            </p>\r\n        );\r\n\r\n    return (\r\n        <Stack gap={4} className=\"chat-box\">\r\n            <div className=\"chat-header\">\r\n                <strong>{recipientUser?.name}</strong>\r\n            </div>\r\n            <Stack gap={3} className=\"messages\">\r\n                {messages && messages.map((message, index) => {\r\n                    return (\r\n                        <Stack key={index} className={` \r\n                            ${message?.senderId === user?._id\r\n                                ? \"message self align-self-end flex-grow-0 \"\r\n                                : \"message align-self-start flex-grow-0\"\r\n                            }`}\r\n                            ref = {scroll} \r\n                            >\r\n                            <span> {message.text}</span>\r\n                            <span className=\"message-footer\">\r\n                                {moment(message.createdAt).calendar()}</span>\r\n                        </Stack>\r\n                    );\r\n\r\n                })}\r\n\r\n            </Stack>\r\n            <Stack direction=\"horizontal\" gap={3} className=\"chat-input flex-grow-0\">\r\n                <InputEmoji\r\n                    value={textMessage}\r\n                    onChange={setTextMessage}\r\n                    borderColor=\"rgba(72,112,223,0.2)\" />\r\n                <button className=\"send-btn\" onClick ={() => sendTextMessage(textMessage,user, currentChat._id, sendTextMessage)}>\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" className=\"bi bi-send-fill\" viewBox=\"0 0 16 16\">\r\n                        <path d=\"M15.964.686a.5.5 0 0 0-.65-.65L.767 5.855H.766l-.452.18a.5.5 0 0 0-.082.887l.41.26.001.002 4.995 3.178 3.178 4.995.002.002.26.41a.5.5 0 0 0 .886-.083zm-1.833 1.89L6.637 10.07l-.215-.338a.5.5 0 0 0-.154-.154l-.338-.215 7.494-7.494 1.178-.471z\" />\r\n                    </svg>\r\n                </button>\r\n            </Stack>\r\n        </Stack>);\r\n\r\n\r\n};\r\n\r\nexport default ChatBox;"],"mappings":";;AAAA,SAASA,UAAU,EAAEC,SAAS,EAAEC,MAAM,EAAEC,QAAQ,QAAQ,OAAO;AAC/D,SAASC,WAAW,QAAQ,2BAA2B;AACvD,SAASC,qBAAqB,QAAQ,+BAA+B;AACrE,SAASC,WAAW,QAAQ,2BAA2B;AACvD,OAAOC,KAAK,MAAM,uBAAuB;AACzC,OAAOC,MAAM,MAAM,QAAQ;AAC3B,OAAOC,UAAU,MAAM,mBAAmB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE3C,MAAMC,OAAO,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAClB,MAAM;IAAEC;EAAK,CAAC,GAAGd,UAAU,CAACI,WAAW,CAAC;EACxC,MAAM;IAAEW,WAAW;IAAEC,QAAQ;IAAEC,iBAAiB;IAAEC;EAAe,CAAC,GAAGlB,UAAU,CAACM,WAAW,CAAC;EAC5F,MAAM;IAAEa;EAAc,CAAC,GAAGd,qBAAqB,CAACU,WAAW,EAAED,IAAI,CAAC;EAClE,MAAM,CAACM,WAAW,EAAEC,cAAc,CAAC,GAAGlB,QAAQ,CAAC,EAAE,CAAC;EAClD,MAAMmB,MAAM,GAAGpB,MAAM,CAAC,CAAC;EAEvBqB,OAAO,CAACC,GAAG,CAAC,MAAM,EAAEJ,WAAW,CAAC;EAChCnB,SAAS,CAAC,MAAM;IAAA,IAAAwB,eAAA;IACZ,CAAAA,eAAA,GAAAH,MAAM,CAACI,OAAO,cAAAD,eAAA,uBAAdA,eAAA,CAAgBE,eAAe,CAAC;MAACC,QAAQ,EAAE;IAAQ,CAAC,CAAC;EAEzD,CAAC,EAAC,CAACZ,QAAQ,CAAC,CAAC;;EAGb;EACA;EACA;;EAEA,IAAI,CAACG,aAAa,EAAE,oBAChBR,OAAA;IAAGkB,KAAK,EAAE;MAAEC,SAAS,EAAE,QAAQ;MAAEC,KAAK,EAAE;IAAO,CAAE;IAAAC,QAAA,EAAC;EAElD;IAAAC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAG,CAAC;EAGR,IAAInB,iBAAiB,EACjB,oBACIN,OAAA;IAAGkB,KAAK,EAAE;MAAEC,SAAS,EAAE,QAAQ;MAAEC,KAAK,EAAE;IAAO,CAAE;IAAAC,QAAA,EAAC;EAElD;IAAAC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAG,CAAC;EAGZ,oBACIzB,OAAA,CAACJ,KAAK;IAAC8B,GAAG,EAAE,CAAE;IAACC,SAAS,EAAC,UAAU;IAAAN,QAAA,gBAC/BrB,OAAA;MAAK2B,SAAS,EAAC,aAAa;MAAAN,QAAA,eACxBrB,OAAA;QAAAqB,QAAA,EAASb,aAAa,aAAbA,aAAa,uBAAbA,aAAa,CAAEoB;MAAI;QAAAN,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAS;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACrC,CAAC,eACNzB,OAAA,CAACJ,KAAK;MAAC8B,GAAG,EAAE,CAAE;MAACC,SAAS,EAAC,UAAU;MAAAN,QAAA,EAC9BhB,QAAQ,IAAIA,QAAQ,CAACwB,GAAG,CAAC,CAACC,OAAO,EAAEC,KAAK,KAAK;QAC1C,oBACI/B,OAAA,CAACJ,KAAK;UAAa+B,SAAS,EAAE;AACtD,8BAA8B,CAAAG,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEE,QAAQ,OAAK7B,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAE8B,GAAG,IAC3B,0CAA0C,GAC1C,sCAAsC,EACzC;UACHC,GAAG,EAAIvB,MAAO;UAAAU,QAAA,gBAEdrB,OAAA;YAAAqB,QAAA,GAAM,GAAC,EAACS,OAAO,CAACK,IAAI;UAAA;YAAAb,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eAC5BzB,OAAA;YAAM2B,SAAS,EAAC,gBAAgB;YAAAN,QAAA,EAC3BxB,MAAM,CAACiC,OAAO,CAACM,SAAS,CAAC,CAACC,QAAQ,CAAC;UAAC;YAAAf,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC;QAAA,GATzCM,KAAK;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAUV,CAAC;MAGhB,CAAC;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAEC,CAAC,eACRzB,OAAA,CAACJ,KAAK;MAAC0C,SAAS,EAAC,YAAY;MAACZ,GAAG,EAAE,CAAE;MAACC,SAAS,EAAC,wBAAwB;MAAAN,QAAA,gBACpErB,OAAA,CAACF,UAAU;QACPyC,KAAK,EAAE9B,WAAY;QACnB+B,QAAQ,EAAE9B,cAAe;QACzB+B,WAAW,EAAC;MAAsB;QAAAnB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eACzCzB,OAAA;QAAQ2B,SAAS,EAAC,UAAU;QAACe,OAAO,EAAGA,CAAA,KAAMnC,eAAe,CAACE,WAAW,EAACN,IAAI,EAAEC,WAAW,CAAC6B,GAAG,EAAE1B,eAAe,CAAE;QAAAc,QAAA,eAC7GrB,OAAA;UAAK2C,KAAK,EAAC,4BAA4B;UAACvB,KAAK,EAAC,IAAI;UAACwB,MAAM,EAAC,IAAI;UAACC,IAAI,EAAC,cAAc;UAAClB,SAAS,EAAC,iBAAiB;UAACmB,OAAO,EAAC,WAAW;UAAAzB,QAAA,eAC9HrB,OAAA;YAAM+C,CAAC,EAAC;UAAmP;YAAAzB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC7P;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACF,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACN,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACL,CAAC;AAGhB,CAAC;AAACvB,EAAA,CArEID,OAAO;EAAA,QAGiBP,qBAAqB;AAAA;AAAAsD,EAAA,GAH7C/C,OAAO;AAuEb,eAAeA,OAAO;AAAC,IAAA+C,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}